
R version 4.0.3 (2020-10-10) -- "Bunny-Wunnies Freak Out"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(onemap)
> source("/opt/scripts/functions_simu.R")
> 
> filtered_onemap <- load("/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-ScatterAt152_14/shard-0/ScatterAt152_14/ed937e1a-552e-4aa1-b459-0ba9bec53eed/call-PolyradMaps/shard-1/SnpBasedGenotypingSimulatedMaps/49d5ed4c-e2b7-4e3c-ad41-4fe7efaf2f7e/call-MapsReport/shard-1/inputs/-1694375118/onemap_obj_filtered.RData")
> filtered_onemap <- get(filtered_onemap)
> 
> simu_onemap_obj <- load("/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-ScatterAt152_14/shard-0/ScatterAt152_14/ed937e1a-552e-4aa1-b459-0ba9bec53eed/call-PolyradMaps/shard-1/SnpBasedGenotypingSimulatedMaps/49d5ed4c-e2b7-4e3c-ad41-4fe7efaf2f7e/call-MapsReport/shard-1/inputs/516657223/simu_vcf_onemap.obj.RData")
> simu_onemap_obj <- get(simu_onemap_obj)
> ref_alt_alleles <- read.table("/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-ScatterAt152_14/shard-0/ScatterAt152_14/ed937e1a-552e-4aa1-b459-0ba9bec53eed/call-PolyradMaps/shard-1/SnpBasedGenotypingSimulatedMaps/49d5ed4c-e2b7-4e3c-ad41-4fe7efaf2f7e/call-MapsReport/shard-1/inputs/1560185715/ref_alt_alleles.txt")
> simulated_phases <- read.table("/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-ScatterAt152_14/shard-0/ScatterAt152_14/ed937e1a-552e-4aa1-b459-0ba9bec53eed/call-PolyradMaps/shard-1/SnpBasedGenotypingSimulatedMaps/49d5ed4c-e2b7-4e3c-ad41-4fe7efaf2f7e/call-MapsReport/shard-1/inputs/1560185715/simulated_phases.txt")
> 
> ## Without false SNPs
> times <-system.time(create_maps_report(input.seq = filtered_onemap,
+                                        tot_mks = ref_alt_alleles, gab = simu_onemap_obj,
+                                        "gatk" , "polyrad0.05",
+                                        fake= F, "bam", simulated_phases))
> 
> outname <- paste0("map_", "gatk", "_", "bam",
+                   "_", "polyrad0.05", "_", FALSE)
> 
> times <- data.frame(meth = outname, time = times[3])
> 
> 
> ## With false SNPs
> times_temp <-system.time(create_maps_report(input.seq = filtered_onemap,
+                                        tot_mks = ref_alt_alleles, gab = simu_onemap_obj,
+                                        "gatk" , "polyrad0.05",
+                                        fake= T, "bam", simulated_phases))
> 
> outname <- paste0("map_", "gatk", "_", "bam",
+                   "_", "polyrad0.05", "_", TRUE)
> 
> # Joint maps data.frames
> map_temp <- read.table("map_gatk_bam_polyrad0.05_TRUE.txt")
> map_joint <- map_temp
> map_temp <- read.table("map_gatk_bam_polyrad0.05_FALSE.txt")
> map_joint <- rbind(map_joint, map_temp)
> write.table(map_joint, file = "map_gatk_bam_polyrad0.05.txt", col.names = F)
> 
> # Joint RDatas
> RDatas_joint <- list()
> map_temp <- load("map_gatk_bam_polyrad0.05_TRUE.RData")
> RDatas_joint[[1]] <- get(map_temp)
> map_temp <- load("map_gatk_bam_polyrad0.05_FALSE.RData")
> RDatas_joint[[2]] <- get(map_temp)
> names(RDatas_joint) <- c("map_gatk_bam_polyrad0.05_TRUE", "map_gatk_bam_polyrad0.05_FALSE")
> save(RDatas_joint, file= "map_gatk_bam_polyrad0.05.RData")
> 
> # Joint times data.frames
> times_temp <- data.frame(meth = outname, time = times_temp[3])
> times <- rbind(times, times_temp)
> write.table(times, "times_gatk_bam_polyrad0.05.txt", col.names = F)
> 
> 
