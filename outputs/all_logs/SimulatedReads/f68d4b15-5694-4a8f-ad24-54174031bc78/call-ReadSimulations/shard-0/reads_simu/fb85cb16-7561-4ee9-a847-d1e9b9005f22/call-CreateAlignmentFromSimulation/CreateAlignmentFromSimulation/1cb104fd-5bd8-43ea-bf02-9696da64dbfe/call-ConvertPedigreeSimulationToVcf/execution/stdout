
R version 4.0.3 (2020-10-10) -- "Bunny-Wunnies Freak Out"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library(onemap)
> library(vcfR)
> 
> mks <- read.table("/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-CreateAlignmentFromSimulation/CreateAlignmentFromSimulation/1cb104fd-5bd8-43ea-bf02-9696da64dbfe/call-ConvertPedigreeSimulationToVcf/inputs/1560185715/ref_alt_alleles.txt", stringsAsFactors = FALSE)
> pos <- mks[,2]
> chr <- mks[,1]
> 
> pedsim2vcf(inputfile = "/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-CreateAlignmentFromSimulation/CreateAlignmentFromSimulation/1cb104fd-5bd8-43ea-bf02-9696da64dbfe/call-ConvertPedigreeSimulationToVcf/inputs/1413987801/sim_genotypes.dat",
+   map.file = "/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-CreateAlignmentFromSimulation/CreateAlignmentFromSimulation/1cb104fd-5bd8-43ea-bf02-9696da64dbfe/call-ConvertPedigreeSimulationToVcf/inputs/1560185715/mapfile.txt",
+   chrom.file = "/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-CreateAlignmentFromSimulation/CreateAlignmentFromSimulation/1cb104fd-5bd8-43ea-bf02-9696da64dbfe/call-ConvertPedigreeSimulationToVcf/inputs/1560185715/chromosome.txt",
+   out.file = "22_10_simu.vcf",
+   miss.perc = 0, counts = FALSE,pos = pos, haplo.ref = "P1_1",
+   chr = chr, phase = TRUE)
> 
> vcfR.object <- read.vcfR("22_10_simu.vcf")
Scanning file to determine attributes.
File attributes:
  meta lines: 4
  header_line: 5
  variant count: 1954
  column count: 31
Meta line 4 read in.
All meta lines processed.
gt matrix initialized.
Character matrix gt created.
  Character matrix gt rows: 1954
  Character matrix gt cols: 31
  skip: 0
  nrows: 1954
  row_num: 0
Processed variant 1000Processed variant: 1954
All variants processed
> INDS_temp <- dimnames(vcfR.object@gt)[[2]][-1]
> inds_sele <- INDS_temp[-c(which(INDS_temp=="P1"), which(INDS_temp=="P2"))]
> 
> progeny_dat <- vcf2progeny_haplotypes(vcfR.object = vcfR.object, ind.id = inds_sele,
+                                       parent1 = "P1", parent2 = "P2",
+                                       crosstype = "outcross")
> 
> haplo_simu <- cbind(seed="22", depth="10",progeny_dat)
> saveRDS(haplo_simu, file = "22_10_haplo_simu.rds")
> 
> 
