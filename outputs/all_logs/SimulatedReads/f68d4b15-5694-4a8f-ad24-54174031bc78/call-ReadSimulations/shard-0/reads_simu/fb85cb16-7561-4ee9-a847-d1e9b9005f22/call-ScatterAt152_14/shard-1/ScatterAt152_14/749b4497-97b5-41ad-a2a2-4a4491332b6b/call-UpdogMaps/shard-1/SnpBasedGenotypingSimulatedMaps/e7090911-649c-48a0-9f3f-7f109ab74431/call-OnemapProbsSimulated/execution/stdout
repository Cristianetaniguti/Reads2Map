
R version 4.0.3 (2020-10-10) -- "Bunny-Wunnies Freak Out"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

>   library(onemap)
>   library(vcfR)
>   library(genotyping4onemap)
>   method <- "updog"
>   vcf <- read.vcfR("/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-ScatterAt152_14/shard-1/ScatterAt152_14/749b4497-97b5-41ad-a2a2-4a4491332b6b/call-UpdogMaps/shard-1/SnpBasedGenotypingSimulatedMaps/e7090911-649c-48a0-9f3f-7f109ab74431/call-OnemapProbsSimulated/inputs/1957315063/freebayes_bam_vcf.vcf")
Scanning file to determine attributes.
File attributes:
  meta lines: 64
  header_line: 65
  variant count: 1390
  column count: 31
Meta line 64 read in.
All meta lines processed.
gt matrix initialized.
Character matrix gt created.
  Character matrix gt rows: 1390
  Character matrix gt cols: 31
  skip: 0
  nrows: 1390
  row_num: 0
Processed variant 1000Processed variant: 1390
All variants processed
> 
>   cross <- "F1"
> 
>   if(cross == "F1"){
+      cross <- "outcross"
+      f1 = NULL
+   } else if (cross == "F2"){
+      cross <- "f2 intercross"
+      f1 = "F1"
+   }
> 
>   onemap_obj_temp <- load("/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-ScatterAt152_14/shard-1/ScatterAt152_14/749b4497-97b5-41ad-a2a2-4a4491332b6b/call-UpdogMaps/shard-1/SnpBasedGenotypingSimulatedMaps/e7090911-649c-48a0-9f3f-7f109ab74431/call-OnemapProbsSimulated/inputs/-1032489328/freebayes_vcf_onemap.obj.RData")
>   onemap_obj <- get(onemap_obj_temp)
> 
>   if (method == "updog") {
+        out_onemap_obj <- updog_genotype(vcfR.object=vcf,
+                                        onemap.object=onemap_obj,
+                                        vcf.par="AD",
+                                        parent1="P1",
+                                        parent2="P2",
+                                        f1 = f1,
+                                        recovering=TRUE,
+                                        mean_phred=20,
+                                        cores=4,
+                                        depths=NULL,
+                                        global_error = NULL,
+                                        use_genotypes_errors = FALSE,
+                                        use_genotypes_probs = TRUE)
+   } else if (method == "supermassa") {
+        out_onemap_obj <- supermassa_genotype(vcfR.object=vcf,
+                                        onemap.object=onemap_obj,
+                                        vcf.par="AD",
+                                        parent1="P1",
+                                        parent2="P2",
+                                        f1 = f1,
+                                        recovering=TRUE,
+                                        mean_phred=20,
+                                        cores=4,
+                                        depths=NULL,
+                                        global_error = NULL,
+                                        use_genotypes_errors = FALSE,
+                                        use_genotypes_probs = TRUE)
+ 
+   } else if (method == "polyrad") {
+        out_onemap_obj <- polyRAD_genotype(vcf="/cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-ScatterAt152_14/shard-1/ScatterAt152_14/749b4497-97b5-41ad-a2a2-4a4491332b6b/call-UpdogMaps/shard-1/SnpBasedGenotypingSimulatedMaps/e7090911-649c-48a0-9f3f-7f109ab74431/call-OnemapProbsSimulated/inputs/1957315063/freebayes_bam_vcf.vcf",
+                                            onemap.obj=onemap_obj,
+                                            parent1="P1",
+                                            parent2="P2",
+                                            f1 = f1,
+                                            crosstype= cross,
+                                            global_error = NULL,
+                                            use_genotypes_errors = FALSE,
+                                            use_genotypes_probs = TRUE)
+ 
+   }
markers 1344 were reestimated as non-informative and removed of analysis 
15 markers were recovered from vcf file and added to onemap object 
This approach changed 1.153846 % of the genotypes 
nNew onemap object contains 41 biallelic markers
> 
>   save(out_onemap_obj, file="updog_onemap_obj.RData")
> 
