
R version 4.0.3 (2020-10-10) -- "Bunny-Wunnies Freak Out"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

>   library(R.utils)
>   system("cp /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-2139471183/F1_01_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/358544754/F1_02_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-1438406605/F1_03_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/1059609332/F1_04_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-737342027/F1_05_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/1760673910/F1_06_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-36277449/F1_07_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-1833228808/F1_08_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/664787129/F1_09_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-1132164230/F1_10_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-1548688528/F1_11_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/949327409/F1_12_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-847623950/F1_13_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/1650391987/F1_14_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/rea+ ds_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-146559372/F1_15_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-1943510731/F1_16_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/554505206/F1_17_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-1242446153/F1_18_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/1255569784/F1_19_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-541381575/F1_20_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/-1419605809/P1_gatk_counts.tsv /cromwell-executions/SimulatedReads/f68d4b15-5694-4a8f-ad24-54174031bc78/call-ReadSimulations/shard-0/reads_simu/fb85cb16-7561-4ee9-a847-d1e9b9005f22/call-GatkGenotyping/GatkGenotyping/aa51a53f-4b4d-4305-91af-1b3dca30da5f/call-BamCounts4Onemap/inputs/1078410128/P2_gatk_counts.tsv .")
>   names <- c("P1 , P2 , F1_01 , F1_02 , F1_03 , F1_04 , F1_05 , F1_06 , F1_07 , F1_08 , F1_09 , F1_10 , F1_11 , F1_12 , F1_13 , F1_14 , F1_15 , F1_16 , F1_17 , F1_18 , F1_19 , F1_20")
>   names <- unlist(strsplit(names, split = " , "))
> 
>   system(paste("grep -n 'CONTIG'", paste0(names[1],"_", "gatk","_counts.tsv"), "> idx"))
>   idx <- read.table("idx", stringsAsFactors = F)
>   idx <- strsplit(idx[,1], ":")[[1]][1]
>   idx <- as.numeric(idx) -1
> 
>   file.counts <- read.table(paste0(names[1],"_", "gatk","_counts.tsv"), skip = idx, header=T, stringsAsFactors = F)
> 
>   ref_depth_matrix2 <- alt_depth_matrix2  <- matrix(NA, nrow = dim(file.counts)[1], ncol = length(names))
> 
>   for(j in 1:length(names)){
+     ## From picard tool
+ 
+     file.counts <- read.table(paste0(names[j],"_", "gatk","_counts.tsv"), skip = idx, header=T, stringsAsFactors = F)
+ 
+     ref_depth_matrix2[,j] <- file.counts[,3]
+     alt_depth_matrix2[,j] <- file.counts[,4]
+ 
+     if (j == 1){
+       ref_allele <- file.counts[,5]
+       alt_allele <- file.counts[,6]
+     } else {
+       idx.ref <- which(ref_allele == "N")
+       idx.alt <- which(alt_allele == "N")
+       if (length(idx.ref)!=0){
+         ref_allele[idx.ref] <- file.counts[idx.ref,5]
+       }
+       if (length(idx.alt)!=0){
+         alt_allele[idx.alt] <- file.counts[idx.alt,6]
+       }
+     }
+ 
+     rownames(ref_depth_matrix2) <- rownames(alt_depth_matrix2) <- paste0(file.counts[,1],"_", file.counts[,2])
+     colnames(ref_depth_matrix2) <- colnames(alt_depth_matrix2) <- names
+ 
+     alleles <- data.frame(file.counts[,1],file.counts[,2], ref_allele, alt_allele)
+     write.table(alleles, file = paste0("gatk","_ref_alt_alleles.txt"), col.names = F, row.names = F)
+ 
+     write.table(ref_depth_matrix2, file = paste0("gatk","_ref_depth_bam.txt"), quote=F, row.names=T, sep="\t", col.names=T)
+     write.table(alt_depth_matrix2, file = paste0("gatk","_alt_depth_bam.txt"), quote=F, row.names=T, sep="\t", col.names=T)
+   }
> 
> 
